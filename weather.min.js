(function(){var t,n,e,o,r,i;r="undefined"!=typeof module&&module.exports,r&&(require("sugar"),o=require("http"),t=require("url")),e=function(t,n){var e,o;for(e in n)o=n[e],t[e]=o;return t},i=function(t,n){return e(e({},t),n)},n=function(){function t(){}return t.VERSION="0.1.0",t.apiUrl="http://api.openweathermap.org/data/2.5/",t.imgUrl="http://openweathermap.org/img/w/",t.options={},t.kelvinToFahrenheit=function(t){return(1.8*this.kelvinToCelsius(t)+32).toFixed(2)},t.kelvinToCelsius=function(t){return(t-273.15).toFixed(2)},t.iconUrl=function(t){return this.imgUrl+t+".png"},t.byCity=function(n){return new t.Request({q:n})},t.byCityId=function(n){return new t.Request({id:n})},t.byLatLng=function(n,e){return new t.Request({lat:n,lon:e})},t}(),n.Request=function(){function e(t){this.options=t}var u;return e.prototype.getCurrent=function(t,e){return null==t&&(t={}),"function"==typeof t&&(e=t,t={}),t=i({cnt:1},this.options,t),u("weather",t,function(){return function(t){return"function"==typeof e?e(new n.Current(t)):void 0}}(this))},e.prototype.getForecast=function(t,e){return null==t&&(t={}),"function"==typeof t&&(e=t,t={}),t=i(this.options,t),u("forecast",t,function(){return function(t){return"function"==typeof e?e(new n.Forecast(t)):void 0}}(this))},u=function(e,u,a){var s,c,p,f;null==u&&(u={}),"function"==typeof u&&(a=u,u={}),u=i(n.options,u),p=n.apiUrl+e;for(s in u)c=u[s],p+=(p.split("?")[1]?"&":"?")+s+"="+encodeURIComponent(c);return r?o.get(t.parse(p),function(t){return a(t.body)}):(f=$.ajax({url:p,dataType:"jsonp"}),f.done(a),f.fail(function(t){return console?console.error(t):void 0}))},e}(),n.Forecast=function(){function t(t){this.data=t}return t.prototype.startAt=function(){return new Date(1e3*this.data.list.min("dt").dt)},t.prototype.endAt=function(){return new Date(1e3*this.data.list.max("dt").dt)},t.prototype.day=function(t){return new n.Forecast(this._filter(t))},t.prototype.low=function(){var t;return this.data.list.length>0?(t=this.data.list.min(function(t){return t.main.temp_min}),t.main.temp_min):void 0},t.prototype.high=function(){var t;return this.data.list.length>0?(t=this.data.list.max(function(t){return t.main.temp_max}),t.main.temp_max):void 0},t.prototype._filter=function(t){var n,e,o;return t instanceof Date&&(t=t.getTime()),e=Object.clone(this.data),n=Date.create(t).beginningOfDay(),o=Date.create(t).endOfDay(),e.list=e.list.findAll(function(t){var e;return e=1e3*t.dt,e>=n.getTime()&&e<=o.getTime()?t:void 0}),e},t}(),n.Current=function(){function t(t){this.data=t}return t.prototype.getSunrise=function(){return new Date(1e3*this.data.sys.sunrise)},t.prototype.getSunset=function(){return new Date(1e3*this.data.sys.sunset)},t.prototype.getLocation=function(){return this.data.name+", "+this.data.sys.country},t.prototype.getMapLink=function(){return"http://openweathermap.org/Maps?zoom=12&lat="+this.data.coord.lat+"&lon="+this.data.coord.lon+"&layers=B0FTTFF"},t.prototype.getConditions=function(){return this.data.weather[0].description},t.prototype.getIcon=function(){return n.iconUrl(this.data.weather[0].icon)},t}(),r?module.exports=n:window.Weather=n}).call(this);