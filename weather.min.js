(function(){var t,n,e,i,r,o;r=typeof module!=="undefined"&&module.exports;if(r){require("sugar");i=require("http");t=require("url")}e=function(t,n){var e,i;for(e in n){i=n[e];t[e]=i}return t};o=function(t,n){return e(e({},t),n)};n=function(){function t(){}t.VERSION="0.1.0";t.apiUrl="http://api.openweathermap.org/data/2.5/";t.imgUrl="http://openweathermap.org/img/w/";t.options={};t.kelvinToFahrenheit=function(t){return this.kelvinToCelsius(t)*1.8+32};t.kelvinToCelsius=function(t){return t-273.15};t.iconUrl=function(t){return this.imgUrl+t+".png"};t.byCity=function(n){return new t.Request({q:n})};t.byCityId=function(n){return new t.Request({id:n})};t.byLatLng=function(n,e){return new t.Request({lat:n,lon:e})};return t}();n.Request=function(){var e;function u(t){this.options=t}u.prototype.getCurrent=function(t,i){if(t==null){t={}}if(typeof t==="function"){i=t;t={}}return e("weather",o({cnt:1},this.options,t,function(t){return function(t){if(typeof i==="function"){return i(new n.Current(t))}}}(this)))};u.prototype.getForecast=function(t,i){if(t==null){t={}}if(typeof t==="function"){i=t;t={}}return e("forecast",o(this.options,t,function(t){return function(t){if(typeof i==="function"){return i(new n.Forecast(t))}}}(this)))};e=function(e,u,a){var f,c,s,p;if(u==null){u={}}if(typeof u==="function"){a=u;u={}}u=o(n.options,u);s=n.apiUrl+e;for(f in u){c=u[f];s+=(s.split("?")[1]?"&":"?")+f+"="+encodeURIComponent(c)}if(r){return i.get(t.parse(s),function(t){return a(t.body)})}else{p=$.ajax({url:s,dataType:"jsonp"});p.done(a);return p.fail(function(t){if(console){return console.error(t)}})}};return u}();n.Forecast=function(){function t(t){this.data=t}t.prototype.startAt=function(){return new Date(this.data.list.min("dt").dt*1e3)};t.prototype.endAt=function(){return new Date(this.data.list.max("dt").dt*1e3)};t.prototype.day=function(t){return new n.Forecast(this._filter(t))};t.prototype.low=function(){var t;if(!(this.data.list.length>0)){return void 0}t=this.data.list.min(function(t){return t.main.temp_min});return t.main.temp_min};t.prototype.high=function(){var t;if(!(this.data.list.length>0)){return void 0}t=this.data.list.max(function(t){return t.main.temp_max});return t.main.temp_max};t.prototype._filter=function(t){var n,e,i;if(t instanceof Date){t=t.getTime()}e=Object.clone(this.data);n=Date.create(t).beginningOfDay();i=Date.create(t).endOfDay();e.list=e.list.findAll(function(t){var e;e=t.dt*1e3;if(e>=n.getTime()&&e<=i.getTime()){return t}});return e};return t}();n.Current=function(){function t(t){this.data=t}t.prototype.getConditions=function(){return this.data.weather[0].description};t.prototype.getIcon=function(){return n.iconUrl(this.data.weather[0].icon)};return t}();if(r){module.exports=n}else{window.Weather=n}}).call(this);